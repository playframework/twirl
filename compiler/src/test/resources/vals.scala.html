@****************************************************************************************************************************************************
 * Copyright (C) from 2022 The Play Framework Contributors <https://github.com/playframework>, 2011-2021 Lightbend Inc. <https://www.lightbend.com> *
 ****************************************************************************************************************************************************@

@()
@val counter = @{ new java.util.concurrent.atomic.AtomicInteger(0) }
@lazy val lazycounter = @{
    // will do nothing yet because we are lazy here
    counter.getAndIncrement()
    counter.getAndIncrement()
    counter.getAndIncrement()
    counter.getAndIncrement()
    new java.util.concurrent.atomic.AtomicInteger(0)
}
@{
    "step1:" + counter.getAndIncrement()
}
@{
    "_step2:" + lazycounter.getAndIncrement()
}
@{
    "_step3:" + lazycounter.getAndIncrement()
}
@{
    "_step4:" + counter.get()
}
@*********************************************************************
* Same again but as def, which will always create new AtomicIntegers *
**********************************************************************@
@defcounter = @{ new java.util.concurrent.atomic.AtomicInteger(0) }
@defcounter2 = @{
    // will do nothing yet because we are lazy here
    counter.getAndIncrement()
    counter.getAndIncrement()
    counter.getAndIncrement()
    counter.getAndIncrement()
    new java.util.concurrent.atomic.AtomicInteger(0)
}
@{
    "_step5:" + defcounter.getAndIncrement()
}
@{
    "_step6:" + defcounter2.getAndIncrement()
}
@{
    "_step7:" + defcounter2.getAndIncrement()
}
@{
    "_step8:" + defcounter.get()
}
@**********************
* Same with templates *
***********************@
@val counter_tmpl = @{ new java.util.concurrent.atomic.AtomicInteger(0) }
@lazy val lazycounter_tmpl = {
    @* we are in a (sub) template now *@
    @{
    // will do nothing yet because we are lazy here
    counter_tmpl.getAndIncrement()
    counter_tmpl.getAndIncrement()
    counter_tmpl.getAndIncrement()
    counter_tmpl.getAndIncrement()
    }
    @* empty *@
}
@{
    "_step9:" + counter_tmpl.getAndIncrement()
}
@{
    "_step10:" + lazycounter_tmpl
}
@{
    "_step11:" + lazycounter_tmpl
}
@{
    "_step12:" + counter_tmpl.get()
}
